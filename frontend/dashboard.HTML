<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü§ñ Ultimate Stock AI Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --bg-color: #f8f9fa;
            --text-color: #212529;
            --accent-color: #007bff;
            --card-bg: #fff;
            --border-color: #dee2e6;
        }
        body.dark-mode {
            --bg-color: #121212;
            --text-color: #e0e0e0;
            --accent-color: #0d6efd;
            --card-bg: #1e1e1e;
            --border-color: #333;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            transition: background 0.3s, color 0.3s;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        header { text-align: center; margin-bottom: 20px; }
        .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 20px; }
        .stat-card { background: var(--card-bg); border: 1px solid var(--border-color); padding: 15px; text-align: center; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .tabs { display: flex; justify-content: center; margin-bottom: 20px; }
        .tab-button { background: none; border: none; padding: 10px 20px; cursor: pointer; font-weight: bold; border-bottom: 2px solid transparent; }
        .tab-button.active { border-bottom-color: var(--accent-color); color: var(--accent-color); }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { border: 1px solid var(--border-color); padding: 8px; text-align: left; }
        th { background: var(--accent-color); color: white; cursor: pointer; }
        .chart-container { background: var(--card-bg); padding: 15px; border-radius: 8px; margin-bottom: 20px; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); justify-content: center; align-items: center; }
        .modal-content { background: var(--card-bg); padding: 20px; border-radius: 8px; max-width: 600px; width: 90%; }
        .close { float: right; cursor: pointer; font-size: 20px; }
        button { background: var(--accent-color); color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; margin: 5px; }
        input { padding: 8px; border: 1px solid var(--border-color); border-radius: 4px; }
        @media (max-width: 768px) { .stats { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ü§ñ Ultimate Stock AI System ‚Ä¢ Security Master DB</h1>
            <p>Multi-Source Data ‚Ä¢ Real-Time AI Analysis ‚Ä¢ Local Caching</p>
            <p>üí∞ Dev Cost: Under $150 | üóÑÔ∏è DB Active | üìß jaysweb@proton.me | üîë API: DQ4I233C...</p>
            <div>
                üìä Sources: Alpha Vantage ‚Ä¢ Yahoo Finance ‚Ä¢ Local Cache ‚Ä¢ AI Analysis
                <span id="api-status">üîÑ API: Checking...</span>
                <span id="last-update">üìà Last Update: Loading...</span>
            </div>
            <button id="theme-toggle">Toggle Dark Mode</button>
        </header>

        <section class="stats">
            <div class="stat-card"><h2 id="total-decisions">0</h2><p>Total AI Decisions</p></div>
            <div class="stat-card"><h2 id="buy-signals">0</h2><p>Buy Signals</p></div>
            <div class="stat-card"><h2 id="avg-confidence">0%</h2><p>Avg Confidence</p></div>
            <div class="stat-card"><h2 id="stocks-tracked">0</h2><p>Stocks Tracked</p></div>
            <div class="stat-card"><h2 id="api-usage">0/25</h2><p>API Usage Today</p></div>
        </section>

        <nav class="tabs">
            <button class="tab-button active" data-tab="analysis">üìà Analysis</button>
            <button class="tab-button" data-tab="decisions">üéØ AI Decisions</button>
            <button class="tab-button" data-tab="watchlist">‚≠ê Watchlist</button>
            <button class="tab-button" data-tab="alerts">üîî Alerts</button>
        </nav>

        <section id="analysis" class="tab-content active">
            <div class="chart-container">
                <h3>üìà AAPL Closing Price Trend ‚Ä¢ Live ‚Ä¢ Auto-refresh 30s</h3>
                <canvas id="price-chart"></canvas>
            </div>
            <div>
                <h3>üìä Stock Price Data</h3>
                <input type="text" id="ticker-input" placeholder="Enter Ticker (e.g., AAPL)" aria-label="Change Ticker">
                <button onclick="changeTicker()">Search</button>
                <button onclick="analyzeStock()">Analyze</button>
                <button onclick="openModal()">AI Analysis</button>
                <button onclick="refreshData()">Refresh</button>
                <button onclick="exportData()">Export CSV</button>
                <table id="price-table">
                    <thead><tr><th>Date</th><th>Open</th><th>High</th><th>Low</th><th>Close</th><th>Volume</th><th>Change</th></tr></thead>
                    <tbody><tr><td colspan="7">Loading data...</td></tr></tbody>
                </table>
                <div class="pagination">
                    <button onclick="prevPage()">Previous</button>
                    <span id="page-num">1</span>
                    <button onclick="nextPage()">Next</button>
                </div>
            </div>
        </section>

        <section id="decisions" class="tab-content">
            <h3>üéØ Recent AI Investment Decisions</h3>
            <table id="decisions-table">
                <thead><tr><th>Ticker</th><th>Decision</th><th>Confidence</th><th>Score</th><th>Expected Return</th><th>Risk</th><th>Timestamp</th></tr></thead>
                <tbody><tr><td colspan="7">Loading decisions...</td></tr></tbody>
            </table>
        </section>

        <section id="watchlist" class="tab-content">
            <h3>‚≠ê Your Watchlist</h3>
            <table id="watchlist-table">
                <thead><tr><th>Ticker</th><th>Name</th><th>Current Price</th><th>AI Signal</th><th>Priority</th><th>Actions</th></tr></thead>
                <tbody><tr><td colspan="6">Loading watchlist...</td></tr></tbody>
            </table>
        </section>

        <section id="alerts" class="tab-content">
            <h3>üîî System Alerts & Notifications</h3>
            <ul id="alerts-list"><li>No active alerts</li></ul>
        </section>
    </div>

    <div id="ai-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h3>üß† AI Analysis Results</h3>
            <div id="ai-results">Running AI analysis...</div>
        </div>
    </div>

    <script>
        // Theme Toggle
        document.getElementById('theme-toggle').addEventListener('click', () => document.body.classList.toggle('dark-mode'));

        // Tab Switching
        document.querySelectorAll('.tab-button').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                btn.classList.add('active');
                document.getElementById(btn.dataset.tab).classList.add('active');
            });
        });

        // Modal
        function openModal() { document.getElementById('ai-modal').style.display = 'flex'; }
        function closeModal() { document.getElementById('ai-modal').style.display = 'none'; }

        // Chart.js Integration (Mock Data)
        let chart;
        function initChart() {
            const ctx = document.getElementById('price-chart').getContext('2d');
            chart = new Chart(ctx, {
                type: 'line',
                data: { labels: [], datasets: [{ label: 'Close Price', data: [], borderColor: '#007bff', fill: false }] },
                options: { responsive: true, scales: { y: { beginAtZero: false } }, plugins: { tooltip: { enabled: true } } }
            });
        }

        // Mock Data Loading (Simulate API)
        let currentTicker = 'AAPL';
        let page = 1;
        const pageSize = 10;
        let priceData = []; // Full dataset

        function loadMockData() {
            // Simulate fetching data
            priceData = Array.from({length: 50}, (_, i) => ({
                date: `2025-08-${String(23 - i).padStart(2, '0')}`,
                open: Math.random() * 200 + 100,
                high: Math.random() * 200 + 100,
                low: Math.random() * 200 + 100,
                close: Math.random() * 200 + 100,
                volume: Math.floor(Math.random() * 1000000),
                change: (Math.random() - 0.5) * 10
            }));
            updateTable();
            updateChart();
            updateStats();
            document.getElementById('api-status').textContent = 'üîÑ API: Active (Mock)';
            document.getElementById('last-update').textContent = `üìà Last Update: ${new Date().toLocaleString()}`;
        }

        function updateTable() {
            const tbody = document.getElementById('price-table').querySelector('tbody');
            tbody.innerHTML = '';
            const start = (page - 1) * pageSize;
            const end = start + pageSize;
            priceData.slice(start, end).forEach(row => {
                const tr = document.createElement('tr');
                tr.innerHTML = `<td>${row.date}</td><td>${row.open.toFixed(2)}</td><td>${row.high.toFixed(2)}</td><td>${row.low.toFixed(2)}</td><td>${row.close.toFixed(2)}</td><td>${row.volume}</td><td>${row.change.toFixed(2)}%</td>`;
                tbody.appendChild(tr);
            });
            document.getElementById('page-num').textContent = page;
        }

        function updateChart() {
            chart.data.labels = priceData.map(d => d.date).reverse();
            chart.data.datasets[0].data = priceData.map(d => d.close).reverse();
            chart.update();
        }

        function updateStats() {
            document.getElementById('total-decisions').textContent = Math.floor(Math.random() * 100);
            document.getElementById('buy-signals').textContent = Math.floor(Math.random() * 20);
            document.getElementById('avg-confidence').textContent = `${Math.floor(Math.random() * 100)}%`;
            document.getElementById('stocks-tracked').textContent = 5;
            document.getElementById('api-usage').textContent = `${Math.floor(Math.random() * 25)}/25`;
        }

        function changeTicker() {
            currentTicker = document.getElementById('ticker-input').value || 'AAPL';
            alert(`Switched to ${currentTicker} - Reloading data...`);
            loadMockData();
        }

        function analyzeStock() { alert('Analyzing stock... (Mock: Positive signal)'); }
        function refreshData() { loadMockData(); }
        function exportData() {
            const csv = 'Date,Open,High,Low,Close,Volume,Change\n' + priceData.map(row => Object.values(row).join(',')).join('\n');
            const blob = new Blob([csv], {type: 'text/csv'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${currentTicker}_data.csv`;
            a.click();
        }
        function prevPage() { if (page > 1) { page--; updateTable(); } }
        function nextPage() { if (page * pageSize < priceData.length) { page++; updateTable(); } }

        // Load Decisions, Watchlist, Alerts (Mock)
        function loadOtherTables() {
            const decisionsTbody = document.getElementById('decisions-table').querySelector('tbody');
            decisionsTbody.innerHTML = '<tr><td>AAPL</td><td>Buy</td><td>85%</td><td>9.2</td><td>15%</td><td>Low</td><td>2025-08-23</td></tr>';
            
            const watchlistTbody = document.getElementById('watchlist-table').querySelector('tbody');
            watchlistTbody.innerHTML = '<tr><td>AAPL</td><td>Apple</td><td>150.00</td><td>Buy</td><td>High</td><td><button>Remove</button></td></tr>';
            
            document.getElementById('alerts-list').innerHTML = '<li>Market volatility alert for AAPL</li>';
            
            document.getElementById('ai-results').innerHTML = 'AI Recommendation: Strong Buy for AAPL based on trend analysis.';
        }

        // Init
        initChart();
        loadMockData();
        loadOtherTables();
        setInterval(refreshData, 30000); // Auto-refresh
    </script>
</body>
</html>